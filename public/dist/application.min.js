!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";angular.module(ApplicationConfiguration.applicationModuleName,ApplicationConfiguration.applicationModuleVendorDependencies),angular.module(ApplicationConfiguration.applicationModuleName).config(["$locationProvider",function(a){a.hashPrefix("!")}]),angular.element(document).ready(function(){"#_=_"===window.location.hash&&(window.location.hash="#!"),angular.bootstrap(document,[ApplicationConfiguration.applicationModuleName])})},{}],2:[function(a,b,c){"use strict";(function(){var a="mean",b=["ngResource","ngCookies","ngAnimate","ngTouch","ngSanitize","ui.router","ui.bootstrap","ui.utils","cfp.hotkeys"],c=function(b,c){angular.module(b,c||[]),angular.module(a).requires.push(b)};return{applicationModuleName:a,applicationModuleVendorDependencies:b,registerModule:c}})()},{}],3:[function(a,b,c){"use strict";angular.module("core").config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("home",{url:"/?date",templateUrl:"modules/core/views/home.client.view.html"}).state("about",{url:"/about",templateUrl:"modules/core/views/about.client.view.html"})}])},{}],4:[function(a,b,c){(function(){"use strict";angular.module("core").controller("HeaderController",["$scope","Authentication","Menus",function(a,b,c){return a.authentication=b,a.isCollapsed=!1,a.menu=c.getMenu("topbar"),a.toggleCollapsibleMenu=function(){a.isCollapsed=!a.isCollapsed},a.$on("$stateChangeSuccess",function(){a.isCollapsed=!1})}])}).call(this)},{}],5:[function(a,b,c){(function(){"use strict";angular.module("core").controller("TextController",["$scope","$http","$stateParams","$location","Authentication","$document","AlertService","WebApiService","TimelineService","hotkeys",function(a,b,c,d,e,f,g,h,i,j){a.authentication=e,a.insertText=function(b){return b?void 0:h.getToday().then(function(b){a.text=b.text,a.state="saved",setInterval(a.save,1e4)},function(a){})},a.text="",a.getWordCounter=function(){return a.text?a.text.trim().split(/\s+/).length:void 0},a.changed=!1,a.$watch("text",function(b,c){a.changed=b!==c&&""!==c,a.changed&&(a.state="notsaved",i.setCounterValue(a.getWordCounter()))}),a.historyText="",a.state="saved",j.add({combo:"ctrl+s",description:"Save",callback:function(b){return b.preventDefault(),b.stopPropagation(),a.save()}}),a.save=function(b){a.changed?(a.state="saving",h.postText(a.text).then(function(c){return c.data.message?void g.send("danger",c.message,3e3):("ctrls"===b&&g.send("success","Продолжайте!","Сохранение прошло успешно!",2e3),a.state="saved",a.changed=!1)},function(a){return"ctrls"===b?g.send("danger","Упс!","Сервер не доступен, продолжайте и попробуйте сохраниться через 5 минут!",4e3):void 0})):"ctrls"===b&&g.send("success","Продолжайте!","Ничего не изменилось с прошлого сохранения!",2e3)},a.showText=function(c){if(a.current_date.setHours(0,0,0,0)>new Date(a.curMonth+"-"+c).setHours(0,0,0,0))c+="",c=2===c.length?c:"0"+c,a.hideToday=!0,a.curDate=new Date(a.curMonth+"-"+c),b.get("/text/"+a.curMonth+"-"+c).success(function(b,c,d){a.historyText=b.text});else{if(a.current_date.setHours(0,0,0,0)!==new Date(a.curMonth+"-"+c).setHours(0,0,0,0))return void g.send("info","Машину времени пока изобретаем","Давайте жить сегодняшним днем!",3e3);a.hideToday=!1,a.historyText="",a.curDate=a.current_date}}}])}).call(this)},{}],6:[function(a,b,c){(function(){angular.module("core").controller("TimelineController",["$scope","TimelineService","$stateParams","$locale",function(a,b,c,d){var e,f;return e=c.date||(new Date).yyyymm(),f=e?e.yyyymmToDate():new Date,a.languageMonth=d.DATETIME_FORMATS.STANDALONEMONTH[+f.getMonth()],a.days=b.getTimeline(e),a.prevmonth=f.prevMonth().yyyymm(),f.nextMonth().isLessThenCurrentMonth()?a.nextmonth=f.nextMonth().yyyymm():void 0}])}).call(this)},{}],7:[function(a,b,c){"use strict";ApplicationConfiguration.registerModule("core")},{}],8:[function(a,b,c){(function(){"use strict";angular.module("core").directive("alerts",[function(){return{templateUrl:"modules/core/views/alerts.client.view.html",restrict:"E"}}])}).call(this)},{}],9:[function(a,b,c){(function(){angular.module("core").directive("authHide",["Authentication",function(a){return{restrict:"A",link:function(b,c,d){return b.authentication=a,b.$watch(b.authentication,function(a,d){return b.authentication.user?c.addClass("ng-hide"):c.removeClass("ng-hide")})}}}]).directive("authShow",["Authentication",function(a){return{restrict:"A",link:function(b,c,d){return b.authentication=a,b.$watch(b.authentication,function(a,d){return b.authentication.user?c.removeClass("ng-hide"):c.addClass("ng-hide")})}}}])}).call(this)},{}],10:[function(a,b,c){(function(){"use strict";angular.module("core").directive("callbackform",[function(){return{templateUrl:"modules/core/views/callbackform.client.view.html",restrict:"E",scope:{},link:function(a,b,c){return b.on("click",function(a){a.preventDefault(),a.stopPropagation()})}}}])}).call(this)},{}],11:[function(a,b,c){(function(){"use strict";angular.module("core").directive("sooHeader",[function(){return{templateUrl:"modules/core/views/header.client.view.html",restrict:"E",controller:"HeaderController",scope:{}}}])}).call(this)},{}],12:[function(a,b,c){(function(){"use strict";angular.module("core").directive("sooText",["TimelineService","AlertService",function(a,b){return{templateUrl:"modules/core/views/text.client.view.html",restrict:"E",controller:"TextController",scope:{textDate:"="},link:function(c,d,e){c.insertText(a.getDay()),c.authentication.user&&b.send("info","С возвращением, "+c.authentication.user.displayName,"Давайте писать!",3e3)}}}])}).call(this)},{}],13:[function(a,b,c){(function(){"use strict";angular.module("core").directive("timeline",[function(){return{templateUrl:"modules/core/views/timeline.client.view.html",restrict:"E",scope:{},controller:"TimelineController"}}])}).call(this)},{}],14:[function(a,b,c){(function(){}).call(this)},{}],15:[function(a,b,c){(function(){"use strict";Date.prototype.yyyymm=function(){var a,b;return b=this.getFullYear().toString(),a=(this.getMonth()+1).toString(),b+"-"+(2===a.length?a:"0"+a)},Date.prototype.yyyymmdd=function(){var a,b,c;return c=this.getFullYear().toString(),b=(this.getMonth()+1).toString(),a=this.getDate().toString(),c+"-"+(2===b.length?b:"0"+b)+"-"+(2===a.length?a:"0"+a)},Date.prototype.nextMonth=function(){return new Date(this.setMonth(this.getMonth()+1))},Date.prototype.prevMonth=function(){return new Date(this.setMonth(this.getMonth()-1))},String.prototype.yyyymmToDate=function(){return new Date(this.slice(0,4),+this.slice(5,7)-1)},Date.prototype.isCurrentMonth=function(){var a,b,c,d,e,f;return f=this,d=new Date,e=d.getFullYear(),b=f.getFullYear(),c=d.getMonth(),a=f.getMonth(),c===a&&e===b},Date.prototype.daysInMonth=function(){return new Date(this.getFullYear(),this.getMonth()+1,0).getDate()},Date.prototype.isLessThenCurrentMonth=function(){var a;return a=new Date,a.setMonth(a.getMonth()-1),Date.parse(a)>Date.parse(this)}}).call(this)},{}],16:[function(a,b,c){(function(){angular.module("core").factory("WebApiService",["$http",function(a){var b;return new(b=function(){function b(){}return b.prototype.getToday=function(){return a.get("/today")},b.prototype.getTimeline=function(b){var c,d,e,f;return f=b.yyyymmToDate(),e=new Date,d=f.daysInMonth(),c=function(){var a,b,c;for(c=[],a=1,b=d;b>=1?b>=a:a>=b;b>=1?a++:a--)c.push("--");return c}(),a.get("/texts/"+b).then(function(a){var b,g;f.isCurrentMonth()&&(b=e.getDate()),f.isLessThenCurrentMonth()&&(b=d),a.data.forEach(function(a){c[new Date(a.date).getDate()-1]=a.counter}),b&&([].splice.apply(c,[0,b-0+1].concat(g=function(){var a,c,d;for(d=[],a=1,c=b;c>=1?c>=a:a>=c;c>=1?a++:a--)d.push(0);return d}())),g)}),c},b.prototype.postText=function(b){return a.post("/texts",{data:{text:b,date:Date.now(),counter:b.trim().split(/\s+/).length}})},b}())}])}).call(this)},{}],17:[function(a,b,c){(function(){"use strict";angular.module("core").factory("AlertService",["$timeout","$rootScope",function(a,b){var c;return new(c=function(){function c(){b.alerts=[]}return c.prototype.send=function(c,d,e,f){b.alerts.push({type:c,title:d,msg:e,close:function(a){return function(){return a.closeAlert(a)}}(this)}),"undefined"==typeof f&&(f=7e3),f&&a(function(a){return function(){a.closeAlert(a)}}(this),f)},c.prototype.closeAlert=function(a){return this.closeAlertIdx(b.alerts.indexOf(a))},c.prototype.closeAlertIdx=function(a){return b.alerts.splice(a,1)},c}())}])}).call(this)},{}],18:[function(a,b,c){angular.module("core").factory("DateService",[function(){var a,b;return b=new Date,a=new Date,{getTodayISO:function(){return b},getTodayString:function(){return b.yyyymmdd()},getTodayDay:function(){return b.getDate()},getTodayMonthString:function(){return b.yyyymm()},daysInMonth:function(a,b){return new Date(year,month+1,0).getDate()},nextMonthString:function(a){return new Date(a.setMonth(a.getMonth()+1)).yyyymm()},prevMonthString:function(a){return new Date(a.setMonth(a.getMonth()-1)).yyyymm()}}}])},{}],19:[function(a,b,c){(function(){angular.module("core").factory("DateService",[function(){var a,b;return b=new Date,a=new Date,{getTodayISO:function(){return b},getTodayString:function(){return b.yyyymmdd()},getTodayDay:function(){return b.getDate()},getTodayMonthString:function(){return b.yyyymm()},daysInMonth:function(a,b){return new Date(year,month+1,0).getDate()},nextMonthString:function(a){return new Date(a.setMonth(a.getMonth()+1)).yyyymm()},prevMonthString:function(a){return new Date(a.setMonth(a.getMonth()-1)).yyyymm()}}}])}).call(this)},{}],20:[function(a,b,c){"use strict";angular.module("core").service("Menus",[function(){this.defaultRoles=["*"],this.menus={};var a=function(a){if(!a)return this.isPublic;if(~this.roles.indexOf("*"))return!0;for(var b in a.roles)for(var c in this.roles)if(this.roles[c]===a.roles[b])return!0;return!1};this.validateMenuExistance=function(a){if(a&&a.length){if(this.menus[a])return!0;throw new Error("Menu does not exists")}throw new Error("MenuId was not provided")},this.getMenu=function(a){return this.validateMenuExistance(a),this.menus[a]},this.addMenu=function(b,c,d){return this.menus[b]={isPublic:c||!1,roles:d||this.defaultRoles,items:[],shouldRender:a},this.menus[b]},this.removeMenu=function(a){this.validateMenuExistance(a),delete this.menus[a]},this.addMenuItem=function(b,c,d,e,f,g,h,i){return this.validateMenuExistance(b),this.menus[b].items.push({title:c,link:d,menuItemType:e||"item",menuItemClass:e,uiRoute:f||"/"+d,isPublic:null===g||"undefined"==typeof g?this.menus[b].isPublic:g,roles:null===h||"undefined"==typeof h?this.menus[b].roles:h,position:i||0,items:[],shouldRender:a}),this.menus[b]},this.addSubMenuItem=function(b,c,d,e,f,g,h,i){this.validateMenuExistance(b);for(var j in this.menus[b].items)this.menus[b].items[j].link===c&&this.menus[b].items[j].items.push({title:d,link:e,uiRoute:f||"/"+e,isPublic:null===g||"undefined"==typeof g?this.menus[b].items[j].isPublic:g,roles:null===h||"undefined"==typeof h?this.menus[b].items[j].roles:h,position:i||0,shouldRender:a});return this.menus[b]},this.removeMenuItem=function(a,b){this.validateMenuExistance(a);for(var c in this.menus[a].items)this.menus[a].items[c].link===b&&this.menus[a].items.splice(c,1);return this.menus[a]},this.removeSubMenuItem=function(a,b){this.validateMenuExistance(a);for(var c in this.menus[a].items)for(var d in this.menus[a].items[c].items)this.menus[a].items[c].items[d].link===b&&this.menus[a].items[c].items.splice(d,1);return this.menus[a]},this.addMenu("topbar")}])},{}],21:[function(a,b,c){(function(){angular.module("core").factory("TimelineService",["WebApiService",function(a){var b,c,d;return c=[],b=(new Date).getDate(),d=[],{getTimeline:function(b){return d[b]?d[b]:(c=a.getTimeline(b),d[b]=c,c)},getDay:function(){return b},setDay:function(a){if("number"==typeof a&&a>0&&30>a)return b=a;throw new Error("Day is not appropriate")},setCounterValue:function(a){return b?c[b].counter=a:void 0}}}])}).call(this)},{}],22:[function(a,b,c){"use strict";angular.module("users").config(["$httpProvider",function(a){a.interceptors.push(["$q","$location","Authentication",function(a,b,c){return{responseError:function(d){switch(d.status){case 401:c.user=null,b.path("signin");break;case 403:}return a.reject(d)}}}])}])},{}],23:[function(a,b,c){"use strict";angular.module("users").config(["$stateProvider",function(a){a.state("profile",{url:"/settings/profile",templateUrl:"modules/users/views/settings/edit-profile.client.view.html"}).state("password",{url:"/settings/password",templateUrl:"modules/users/views/settings/change-password.client.view.html"}).state("accounts",{url:"/settings/accounts",templateUrl:"modules/users/views/settings/social-accounts.client.view.html"}).state("signup",{url:"/signup",templateUrl:"modules/users/views/authentication/signup.client.view.html"}).state("signin",{url:"/signin",templateUrl:"modules/users/views/authentication/signin.client.view.html"}).state("forgot",{url:"/password/forgot",templateUrl:"modules/users/views/password/forgot-password.client.view.html"}).state("reset-invalid",{url:"/password/reset/invalid",templateUrl:"modules/users/views/password/reset-password-invalid.client.view.html"}).state("reset-success",{url:"/password/reset/success",templateUrl:"modules/users/views/password/reset-password-success.client.view.html"}).state("reset",{url:"/password/reset/:token",templateUrl:"modules/users/views/password/reset-password.client.view.html"})}])},{}],24:[function(a,b,c){"use strict";angular.module("users").controller("AuthenticationController",["$scope","$http","$location","Authentication",function(a,b,c,d){a.authentication=d,a.authentication.user&&c.path("/"),a.signup=function(){b.post("/auth/signup",a.credentials).success(function(b){a.authentication.user=b,c.path("/")}).error(function(b){a.error=b.message})},a.signin=function(){b.post("/auth/signin",a.credentials).success(function(b){a.authentication.user=b,c.path("/")}).error(function(b){a.error=b.message})}}])},{}],25:[function(a,b,c){"use strict";angular.module("users").controller("PasswordController",["$scope","$stateParams","$http","$location","Authentication",function(a,b,c,d,e){a.authentication=e,a.authentication.user&&d.path("/"),a.askForPasswordReset=function(){a.success=a.error=null,c.post("/auth/forgot",a.credentials).success(function(b){a.credentials=null,a.success=b.message}).error(function(b){a.credentials=null,a.error=b.message})},a.resetUserPassword=function(){a.success=a.error=null,c.post("/auth/reset/"+b.token,a.passwordDetails).success(function(b){a.passwordDetails=null,e.user=b,d.path("/password/reset/success")}).error(function(b){a.error=b.message})}}])},{}],26:[function(a,b,c){"use strict";angular.module("users").controller("SettingsController",["$scope","$http","$location","Users","Authentication",function(a,b,c,d,e){a.user=e.user,a.user||c.path("/"),a.hasConnectedAdditionalSocialAccounts=function(b){for(var c in a.user.additionalProvidersData)return!0;return!1},a.isConnectedSocialAccount=function(b){return a.user.provider===b||a.user.additionalProvidersData&&a.user.additionalProvidersData[b]},a.removeUserSocialAccount=function(c){a.success=a.error=null,b["delete"]("/users/accounts",{params:{provider:c}}).success(function(b){a.success=!0,a.user=e.user=b}).error(function(b){a.error=b.message})},a.updateUserProfile=function(b){if(b){a.success=a.error=null;var c=new d(a.user);c.$update(function(b){a.success=!0,e.user=b},function(b){a.error=b.data.message})}else a.submitted=!0},a.changeUserPassword=function(){a.success=a.error=null,b.post("/users/password",a.passwordDetails).success(function(b){a.success=!0,a.passwordDetails=null}).error(function(b){a.error=b.message})}}])},{}],27:[function(a,b,c){"use strict";angular.module("users").factory("Authentication",[function(){var a=this;return a._data={user:window.user},a._data}])},{}],28:[function(a,b,c){"use strict";angular.module("users").factory("Users",["$resource",function(a){return a("users",{},{update:{method:"PUT"}})}])},{}],29:[function(a,b,c){"use strict";ApplicationConfiguration.registerModule("users")},{}]},{},[2,1,7,29,3,4,5,6,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]);