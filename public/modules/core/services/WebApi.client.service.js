// Generated by CoffeeScript 1.10.0
(function() {
  angular.module('core').factory("WebApiService", [
    '$http', function($http) {
      var WebApiService;
      return new (WebApiService = (function() {
        function WebApiService() {
          return;
        }

        WebApiService.prototype.getToday = function() {
          return $http.get('/today');
        };

        WebApiService.prototype.getTimeline = function(year, month) {
          var date, days, daysN, request_string, sm, sy, today;
          date = new Date(new Date(year, month).setHours(0, 0, 0, 0));
          today = new Date((new Date()).setHours(0, 0, 0, 0));
          sy = date.getFullYear();
          sm = date.getMonth();
          request_string = sy + "-" + ("0" + (sm + 1)).slice(-2);
          daysN = new Date(year, month + 1, 0).getDate();
          days = (function() {
            var i, ref, results;
            results = [];
            for (i = 1, ref = daysN; 1 <= ref ? i <= ref : i >= ref; 1 <= ref ? i++ : i--) {
              results.push(0);
            }
            return results;
          })();
          $http.get('/texts/' + request_string).then(function(data) {
            var limit, ref;
            limit = today.getDate();
            data.data.forEach(function(e) {
              days[(new Date(e.date)).getDate() - 1] = e.counter;
            });
            [].splice.apply(days, [limit, daysN - limit + 1].concat(ref = (function() {
              var i, ref1, ref2, results;
              results = [];
              for (i = ref1 = limit, ref2 = daysN; ref1 <= ref2 ? i <= ref2 : i >= ref2; ref1 <= ref2 ? i++ : i--) {
                results.push('--');
              }
              return results;
            })())), ref;
          });
          return days;
        };

        WebApiService.prototype.postText = function(textString) {
          return $http.post('/texts', {
            data: {
              text: textString,
              date: Date.now(),
              counter: textString.trim().split(/\s+/).length
            }
          });
        };

        return WebApiService;

      })());
    }
  ]);

}).call(this);

//# sourceMappingURL=WebApi.client.service.js.map
